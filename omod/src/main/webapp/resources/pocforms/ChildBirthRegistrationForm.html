<htmlform formUuid="5fc9a1f0-39b7-4e18-a220-4d34dc6b6368" formName="Child Birth Registration" formEncounterType="51139c37-6fc2-4858-8a62-a57e08655262" formVersion="2018">
    <!-- Autogenerated example form  (template from 01-Nov-2010 -->
    <macros>
        paperFormId = (Fill this in)
        headerColor =#2f1c55
        fontOnHeaderColor = white
    </macros>
    <style>
        .section {
        border: 1px solid $headerColor;
        padding: 2px;
        text-align: left;
        margin-bottom: 1em;
        }
        .sectionHeader {
        background-color: #2f1c55;
        color: white;
        /* display: block; */
        padding: 2px;
        font-weight: bold;
        }
        table tr:nth-child(even) {
        background: #ffffff;
        }
        .alnright{
        text-align: right;
        color:#000000;
        width: 25%;
        }
        .alnright_s{
        text-align: right;
        color:#000000;
        width: 13%;
        }
        .alnleft_s{
        text-align: left;
        color:#000000;
        width: 13%;
        }
        .alnleft{
        text-align: left;
        color:#000000;
        width: 25%;
        }
        td {
        border: none;
        }
        table th, table td {
        padding: 5px 10px;
        border: None;
        }
        .legend_style {
        max-width: 35%;
        background: #FAFAFA;
        margin: 0px left;
        box-shadow: 1px 1px 25px rgba(0,0,0,0.10);
        border-radius: 2px;
        border: 1px solid #305a72;
        border-bottom-left-radius: 2px;
        text-transform:initial;

        }
        form fieldset, .form fieldset {
        min-width: 98%;
        border: none;
        border-top: 1px solid #305a72;

        }
        table th, table td {
        padding: 5px 10px;
        /* border: 1px solid #DDD; */
        }
        table tr {
        border: None;
        }
        ul.select, .form input, .form select, .form textarea, .form ul.select {
        padding: 2px 10px;
        }
        form input, form select, form textarea, form ul.select, .form input, .form select, .form textarea, .form ul.select {
        padding: 2px 10px;
        min-width: 150px;
        max-width: 150px;
        }
        form select, .form select {
        max-width: 150px;
        min-width: 150px;
        }
        body {
        font-family: "OpenSans", Arial, sans-serif;
        color: #363463;
        font-size: 14px;
        }
   
    </style>


<script type="text/javascript">
          jQuery(function() {
            
                        jQuery('.datefield').find("input").attr("readonly",true);
jQuery('.hasDatepicker').attr('readonly', true)
                                         
                        });

    </script>




    <script type="text/javascript">
    beforeSubmit.push(function() {
        var val_encounterDate = getValue('Visit_ID.value');
        var val_enrollInProgram = getValue('Enrollment_ID.value');
        if (val_enrollInProgram > val_encounterDate) {
            getField('Visit_ID.error').html('Visit Date has to be later than Enrollment Date').show();
            return false;
        }

        return true;
    });
    </script>
    <script type="text/javascript">
    var $ = jQuery;


    $(document).ready(function() {
        $.ajax({
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            url: "/openmrs/nigeriaemr/PatientIdTypeSetter/getIdentifier.action",
            data: { patientId: $('input[name=personId]').val(), identifierType: $('#pref_type').val() },
            cache: false,
            timeout: 600000,
            success: function(r) {
                if (r.code > 0) {
                    if (r.identifier.length > 0) {
                        if (r.preferred === true) {
                            $('#preferred').prop("checked", 'checked');
                        }
                    }
                }
            },
            error: function(e) {
                console.log("ERROR : ", e);
            }
        });


        $('#preferred').click(function(e) {
            var patientIdentifier = $('input:text', '#identifer-td').eq(0).val();
            if (patientIdentifier) {
                if (patientIdentifier.trim().length > 0) {
                    var obj = e.target;
                    var isPreferred = false;
                    if ($(obj).prop("checked") == true) {
                        isPreferred = true;
                    }

                    var patientId = $('input[name=personId]').val();
                    var identifierType = $('#pref_type').val();

                    var pid = { patientId: patientId, patientIdentifier: patientIdentifier, identifierType: identifierType, isPreferred: isPreferred };
                    var link = "/openmrs/nigeriaemr/PatientIdTypeSetter/setPidType.action";

                    $.ajax({
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        url: link,
                        data: pid,
                        cache: false,
                        timeout: 600000,
                        success: function(r) {
                            if (r.code !== 5) {
                                alert(r.message);
                            }
                        },
                        error: function(e) {
                            console.log("ERROR : ", e);
                        }
                    });
                } else {
                    $('#preferred').prop("checked", '');
                    alert('Please fill in the HEI No. before setting as preferred');
                }
            } else {
                $('#preferred').prop("checked", '');
                alert('Please fill in the HEI No. before setting as preferred');
            }
        });
    });
    </script>
 
    <span style="float:right">Paper Form ID: $paperFormId</span>
    <table style="margin-bottom: 20px;">
        <thead>
            <tr>
                <th style="text-align: center">Child Birth Information</th>
            </tr>
        </thead>
    </table>
    <fieldset>
        <legend class="legend_style">Birth Details</legend>
        <table width="100%">
            <tr>
                <td class="alnright_s">HEI No.</td>
                <td class="alnleft_s" id="identifer-td">
                    <patient field="identifier" identifierTypeId="7" required="true" />
                </td>
                <td style="vertical-align: top;">
                    <label> <input type="checkbox" name="preferred" id="preferred" />preferred</label>
                    <input type="hidden" name="pref_value" id="pref_value" />
                    <input type="hidden" name="pref_type" id="pref_type" value="7" />
                </td>
                <td class="alnright_s">Enrollment Date</td>
                <td>
                    <enrollInProgram programId="3" showDate="false" />
                    <encounterDate class="datefield" showTime="false" id="date_enrolled" />
                </td>

           </tr>
            <tr>
                <td class="alnright_s">Weight(kg):</td>
                <td class="alnleft_s">
                    <obs conceptId="5916" />
                </td>
                <td class="alnright_s">Length(cm):</td>
                <td class="alnleft_s">
                    <obs conceptId="1503" />
                </td>
                <td class="alnright_s">Head circumference(cm):</td>
                <td class="alnleft_s">
                    <obs conceptId="5314" />
                </td>
            </tr>
            <tr>
                <td class="alnright_s">MUAC</td>
                <td class="alnright_s">
                    <obs conceptId="165935" answerConceptIds="165933,165934" answerLabels="Less than or equal to 12.5cm (Under weight), Greter than 12.5cm (Normal)" />
                </td>
                <td class="alnright_s">APGAR Score:</td>
                <td class="alnleft_s">
                    <obs conceptId="1504" />
                </td>
                <td class="alnright_s">Child given Hepatitis B Immunoglobulin (Hep B Ig)?:</td>
                <td class="alnleft_s">
                    <obs conceptId="165667" />
                </td>
            </tr>
            <tr>
                <td class="alnright_s">High risk HIV exposed Infant?:</td>
                <td class="alnleft_s">
                    <obs conceptId="165668" />
                </td>
                <td class="alnright_s">ARV Prophylaxis</td>
                <td class="alnleft_s">
                    <obs conceptId="164971" answers="164970,165544" answerLabels="NVP, AZT-NVP" />
                </td>
                <td class="alnright_s">Timing of ARV Prophylaxis:</td>
                <td class="alnleft_s">
                    <obs conceptId="165864" answers="165860,165862,165861,165863" answerLabels="Facility delivery within 72hrs, Facility delivery after 72hrs, Delivered outside facility within 72hrs, Delivered outside facility after 72hrs"/>
                </td>
            </tr>
        </table>
    </fieldset><br />
    <fieldset>
        <legend class="legend_style">Immunization Detail</legend>
        <table width="100%">
            <tr>
                <td width="25%">Immunization received at birth:</td>
                <td width="25%">
                    <obs conceptId="165930" answerConceptId="71902" answerLabel="BCG Vaccination" /><br />
                    <obs conceptId="165930" answerConceptId="782" answerLabel="Hepatitis B Vaccination" /><br />
                    <obs conceptId="165930" answerConceptId="783" answerLabel="Oral Polio Vaccination" />
                </td>
                <td width="25%"></td>
                <td width="25%"></td>
            </tr>
        </table>
    </fieldset><br />
    <fieldset>
        <legend class="legend_style">Signature</legend>
        <table width="100%">
            <tr>
                <td class="alnright_s">Visit Date:</td>
                <td class="alnleft_s">
                    <encounterDate default="now" showTime="false" allowFutureDates="false" id="Visit_ID" />
                </td>
                <td class="alnright_s">Enrolled by:</td>
                <td class="alnleft_s">
                    <encounterProvider default="currentUser" />
                </td>
                <td class="alnright_s">Facility:</td>
                <td>
                    <encounterLocation default="SessionAttribute:emrContext.sessionLocationId" />
                </td>
            </tr>
        </table>
    </fieldset>
    <submit />
</htmlform>